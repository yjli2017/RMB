# Write each metadata to a CSV file
for (i in 1:length(monitor_list)) {
write.csv(metadata_list[[i]], file = paste0(dir_path, "/", tools::file_path_sans_ext(basename(monitor_list[i])), "_metadata.csv"), row.names = FALSE)
}
}
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list)
View(update_metadata)
metadata_list <- create_metadata_list(monitor_list)
# update as you need
Date = "20230606"
tube_type = "normal"
User = "yjli"
Experiment = "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
source("./src/metadata.R")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
# update as you need
Date = "20230606"
tube_type = "normal"
User = "yjli"
Experiment = "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
View(update_metadata)
View(update_metadata)
source("./src/metadata.R")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
# update as you need
Date = "20230606"
tube_type = "normal"
User = "yjli"
Experiment = "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
source("./src/metadata.R")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
# update as you need
Date = "20230606"
tube_type = "normal"
User = "yjli"
Experiment = "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
View(metadata_list)
source("./src/metadata.R")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
# update as you need
Date = "20230606"
tube_type = "normal"
User = "yjli"
Experiment = "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
View(update_metadata)
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
source("./src/metadata.R")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
# update as you need
Date = "20230606"
tube_type = "normal"
User = "yjli"
Experiment = "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
source("./src/metadata.R")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
# update as you need
Date = "20230606"
tube_type = "normal"
User = "yjli"
Experiment = "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
# update as you need
Date <- "20230606"
tube_type <- "normal"
User <- "yjli"
Experiment <- "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
source("./src/metadata.R")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
# update as you need
Date <- "20230606"
tube_type <- "normal"
User <- "yjli"
Experiment <- "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
# update as you need
Date <- "20230606"
tube_type <- "normal"
User <- "yjli"
Experiment <- "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
source("./src/metadata.R")
monitor_list <- load_monitor_files(data_dir)
source("./src/metadata.R")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
# update as you need
Date <- "20230606"
tube_type <- "normal"
User <- "yjli"
Experiment <- "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
source("./output_metadata.R")
write_metadata(data_dir, monitor_list, metadata_list)
# Create or update the the metadata for the test data
# load the config file
source("./config/config.R")
# test
data_dir <- "./test"
metadata_info <- read.csv("./test/metadata_info.csv")
source("./src/metadata.R")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
# update as you need
Date <- "20230606"
tube_type <- "normal"
User <- "yjli"
Experiment <- "test"
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
write_metadata(data_dir, monitor_list, metadata_list)
# load the config file
source("./config/config.R")
# test
data_dir <- "./test"
metadata_info <- read.csv("./test/metadata_info.csv")
# load the config file
source("./config/config.R")
# test
data_dir <- "./test"
metadata_info <- read.csv("./test/metadata_info.csv")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
# update as you need
Date <- "20230606"
tube_type <- "normal"
User <- "yjli"
Experiment <- "test"
# load the config file
source("./config/config.R")
################################################################################
# update as you need
Date <- "20230606"
tube_type <- "normal"
User <- "yjli"
Experiment <- "test"
################################################################################
# test
data_dir <- "./test"
metadata_info <- read.csv("./test/metadata_info.csv")
monitor_list <- load_monitor_files(data_dir)
print(monitor_list)
print(length(monitor_list))
metadata_list <- create_metadata_list(monitor_list)
metadata_list <- update_metadata(monitor_list, metadata_list, Date, tube_type, User, Experiment)
# load metadata_info
metadata_info <- read.csv("./test/metadata_info.csv")
View(metadata_info)
metadata_info
metadata_list[[1]]$Monitor_number <- metadata_info$Monitor_number[1]
metadata_list[[1]]$Phenotype[metadata_info$Start_channel[1]:metadata_info$End_channel[1]] <- metadata_info$Date[1]$Phenotype
# modify as you can or manually update metadata_
# Update metadata_list with information from metadata_info
for (i in 1:6) {
metadata_list[[i]]$Monitor_number <- metadata_info$Monitor_number[i]
metadata_list[[i]]$Phenotype <- metadata_info$Phenotype[i]
}
write_metadata(data_dir, monitor_list, metadata_list)
source("./config/config.R")
################################################################################
# Load the config
source("./config/config.R")
################################################################################
data_dir = "./test"
# Load data
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
data_dir = "./test"
# Load data
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
# Run metadata R first
metadata_list <- list()
metadata_list <- list.files(path = file.path(data_dir, "metadata/"),
pattern = "metadata", full.names = TRUE)
for (i in 1:length(metadata_list)) {
monitor_list[[i]]@meta.data <- read.csv(metadata_list[i])
}
dim(monitor_list[[1]]@meta.data)
################################################################################
# process the data
source("./src/process_monitorS4_data.R")
for (i in 1:length(monitor_list)) {
monitor_list[[i]] <- process_monitorS4_data(monitor_list[[i]])
}
View(monitor_list)
################################################################################
# select time range based on light on and off
source("./src/select_time_range.R")
monitor_list <- select_time_range(monitor_list)
################################################################################
# Load the config
source("./config/config.R")
################################################################################
# select time range based on light on and off
source("./src/select_time_range.R")
monitor_list <- select_time_range(monitor_list)
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
# Run metadata R first
metadata_list <- list()
metadata_list <- list.files(path = file.path(data_dir, "metadata/"),
pattern = "metadata", full.names = TRUE)
for (i in 1:length(metadata_list)) {
monitor_list[[i]]@meta.data <- read.csv(metadata_list[i])
}
dim(monitor_list[[1]]@meta.data)
################################################################################
# process the data
source("./src/process_monitorS4_data.R")
for (i in 1:length(monitor_list)) {
monitor_list[[i]] <- process_monitorS4_data(monitor_list[[i]])
}
################################################################################
# select time range based on light on and off
source("./src/select_time_range.R")
monitor_list <- select_time_range(monitor_list)
View(monitor_list)
data_dir = "./test"
# Load data
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
# Run metadata R first
metadata_list <- list()
metadata_list <- list.files(path = file.path(data_dir, "metadata/"),
pattern = "metadata", full.names = TRUE)
for (i in 1:length(metadata_list)) {
monitor_list[[i]]@meta.data <- read.csv(metadata_list[i])
}
dim(monitor_list[[1]]@meta.data)
################################################################################
# process the data
source("./src/process_monitorS4_data.R")
for (i in 1:length(monitor_list)) {
monitor_list[[i]] <- process_monitorS4_data(monitor_list[[i]])
}
################################################################################
# select time range based on light on and off
source("./src/select_time_range.R")
monitor_list <- select_time_range(monitor_list)
################################################################################
data_dir = "./test"
# Load data
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
# Run metadata R first
metadata_list <- list()
metadata_list <- list.files(path = file.path(data_dir, "metadata/"),
pattern = "metadata", full.names = TRUE)
for (i in 1:length(metadata_list)) {
monitor_list[[i]]@meta.data <- read.csv(metadata_list[i])
}
dim(monitor_list[[1]]@meta.data)
################################################################################
# process the data
source("./src/process_monitorS4_data.R")
for (i in 1:length(monitor_list)) {
monitor_list[[i]] <- process_monitorS4_data(monitor_list[[i]])
}
################################################################################
# select time range based on light on and off
source("./src/select_time_range.R")
monitor_list <- select_time_range(monitor_list)
# Author: Yongjun Li 2024-02-15
################################################################################
# Load the config
source("./config/config.R")
################################################################################
# select time range based on light on and off
monitor_list <- select_time_range(monitor_list)
################################################################################
# select time range based on light on and off
monitor_list <- select_time_range(monitor_list)
# Author: Yongjun Li 2024-02-15
################################################################################
# Load the config
source("./config/config.R")
################################################################################
data_dir = "./test"
# Load data
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
# Run metadata R first
metadata_list <- list()
metadata_list <- list.files(path = file.path(data_dir, "metadata/"),
pattern = "metadata", full.names = TRUE)
for (i in 1:length(metadata_list)) {
monitor_list[[i]]@meta.data <- read.csv(metadata_list[i])
}
dim(monitor_list[[1]]@meta.data)
################################################################################
# process the data
for (i in 1:length(monitor_list)) {
monitor_list[[i]] <- process_monitorS4_data(monitor_list[[i]])
}
################################################################################
# select time range based on light on and off
monitor_list <- select_time_range(monitor_list)
################################################################################
# Load the config
source("./config/config.R")
################################################################################
data_dir = "./test"
# Load data
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
# Run metadata R first
metadata_list <- list()
metadata_list <- list.files(path = file.path(data_dir, "metadata/"),
pattern = "metadata", full.names = TRUE)
for (i in 1:length(metadata_list)) {
monitor_list[[i]]@meta.data <- read.csv(metadata_list[i])
}
dim(monitor_list[[1]]@meta.data)
################################################################################
# process the data
for (i in 1:length(monitor_list)) {
monitor_list[[i]] <- process_monitorS4_data(monitor_list[[i]])
}
################################################################################
# select time range based on light on and off
monitor_list <- select_time_range(monitor_list)
################################################################################
# Load the config
################################################################################
# Load the config
source("./config/config.R")
################################################################################
data_dir = "./test"
# Load data
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
# Run metadata R first
metadata_list <- list()
metadata_list <- list.files(path = file.path(data_dir, "metadata/"),
pattern = "metadata", full.names = TRUE)
for (i in 1:length(metadata_list)) {
monitor_list[[i]]@meta.data <- read.csv(metadata_list[i])
}
dim(monitor_list[[1]]@meta.data)
################################################################################
# process the data
for (i in 1:length(monitor_list)) {
monitor_list[[i]] <- process_monitorS4_data(monitor_list[[i]])
}
################################################################################
# select time range based on light on and off
monitor_list <- select_time_range(monitor_list)
data_dir = "./test"
# Load data
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
# Run metadata R first
metadata_list <- list()
metadata_list <- list.files(path = file.path(data_dir, "metadata/"),
pattern = "metadata", full.names = TRUE)
for (i in 1:length(metadata_list)) {
monitor_list[[i]]@meta.data <- read.csv(metadata_list[i])
}
dim(monitor_list[[1]]@meta.data)
################################################################################
# process the data
for (i in 1:length(monitor_list)) {
monitor_list[[i]] <- process_monitorS4_data(monitor_list[[i]])
}
################################################################################
# select time range based on light on and off
source("./src/select_time_range.R")
monitor_list <- select_time_range(monitor_list)
View(monitor_list)
data_dir = "./test"
# Load data
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
# Run metadata R first
metadata_list <- list()
metadata_list <- list.files(path = file.path(data_dir, "metadata/"),
pattern = "metadata", full.names = TRUE)
for (i in 1:length(metadata_list)) {
monitor_list[[i]]@meta.data <- read.csv(metadata_list[i])
}
dim(monitor_list[[1]]@meta.data)
################################################################################
# process the data
for (i in 1:length(monitor_list)) {
monitor_list[[i]] <- process_monitorS4_data(monitor_list[[i]])
}
################################################################################
# select time range based on light on and off
source("./src/select_time_range.R")
monitor_list <- select_time_range(monitor_list)
View(monitor_list)
################################################################################
# select time range based on light on and off
source("./src/select_time_range.R")
monitor_list <- select_time_range(monitor_list)
data_dir = "./test"
# Load data
# Get a list of all the .txt files in the directory
monitor_list <- load_monitor_files(data_dir)
monitor_list <- sapply(monitor_list, create_monitorS4)
################################################################################
# Run metadata R first
metadata_list <- list()
metadata_list <- list.files(path = file.path(data_dir, "metadata/"),
pattern = "metadata", full.names = TRUE)
for (i in 1:length(metadata_list)) {
monitor_list[[i]]@meta.data <- read.csv(metadata_list[i])
}
dim(monitor_list[[1]]@meta.data)
################################################################################
# process the data
for (i in 1:length(monitor_list)) {
monitor_list[[i]] <- process_monitorS4_data(monitor_list[[i]])
}
################################################################################
# select time range based on light on and off
source("./src/select_time_range.R")
monitor_list <- select_time_range(monitor_list)
View(monitor_list)
################################################################################
# merge the data
monitor <- mergeMonitorS4(monitor_list)
################################################################################
# get rid of dead flies
monitor <- remove_dead_flies(monitor)
################################################################################
# get rid of dead flies
source("./src/remove_dead_flies.R")
monitor <- remove_dead_flies(monitor)
View(monitor)
################################################################################
# get rid of dead flies
source("./src/remove_dead_flies.R")
monitor <- remove_dead_flies(monitor)
################################################################################
# merge the data
monitor <- mergeMonitorS4(monitor_list)
################################################################################
# get rid of dead flies
source("./src/remove_dead_flies.R")
monitor <- remove_dead_flies(monitor)
View(monitor)
################################################################################
# merge the data
monitor <- mergeMonitorS4(monitor_list)
################################################################################
# get rid of dead flies
source("./src/remove_dead_flies.R")
monitor <- remove_dead_flies(monitor)
View(monitor)
